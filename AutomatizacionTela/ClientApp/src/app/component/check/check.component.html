<div class="container mt-4">
    <div class="row">
      <div class="card mask-body p-0">
        <div class="card-body text-center">
          <div class="row">
            <p class="h4 font-weight-bold mb-1 text-black text-start">
              Chequear Telas
            </p>
            <div class="container">
              <div class="card mask-custom p-1">
                <div class="card-body">
                  <div class="row star-content-center">
                    <div class="col-md-3 mb-0 mb-md-0">
                      <div id="basic" class="form-outline form-white">
                        <input
                          type="text"
                          id="form1"
                          class="form-control form-control-md"
                          [(ngModel)]="searchLot"
                          (ngModelChange)="searchRoll = undefined"
                          [disabled]="searchRoll != null && searchRoll != 0"
                          placeholder="Busqueda por Lote"
                        />
                      </div>
                    </div>
                    <div class="col-md-2 mb-3 mb-md-0">
                      <div id="location" class="form-outline form-white">
                        <input
                          type="text"
                          id="form2"
                          class="form-control form-control-md"
                          [(ngModel)]="searchRoll"
                          (ngModelChange)="searchLot = ''"
                          [disabled]="searchLot.length > 0"
                          placeholder="Busqueda por Rollo"
                        />
                      </div>
                    </div>
                    <div class="col-md-1 mb-3 mb-md-0">
                      <button
                        type="button"
                        class="btn btn-dark btn-floating"
                        type="submit"
                        data-mdb-ripple-init
                        (click)="searchCheck()"
                        aria-label="Search"
                      >
                        <i class="fa-solid fa-magnifying-glass fa-xl"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <table
              class="table table-striped mt-3 table-hover"
              *ngIf="dataFromDB.length > 0"
            >
              <thead class="table-dark">
                <tr>
                  <th scope="col">Proveedor</th>
                  <th scope="col">Lote</th>
                  <th scope="col">Tela</th>
                  <th scope="col">Descripción</th>
                  <th scope="col">Color</th>
                  <th scope="col">Kilos</th>
                  <th scope="col">Pedido</th>
                  <th scope="col">Referencia</th>
                  <th scope="col">Remisión</th>
                  <th scope="col">Total Rollos</th>
                  <th></th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of dataFromDB; let i = index">
                  <td>{{ item.nameProvider }}</td>
                  <td>{{ item.lot }}</td>
                  <td>{{ item.codeCloth }}</td>
                  <td>{{ item.nameCloth }}</td>
                  <td>{{ item.codeColor }}</td>
                  <td>{{ item.kiloRoll }}</td>
                  <td>{{ item.request }}</td>
                  <td>{{ item.reference }}</td>
                  <td>{{ item.remision }}</td>
                  <td>{{ item.quantityRoll }}</td>
                  <td>
                    <button
                    (click)="updateUserInputs(item)"
                      type="button"
                      class="btn-modal"
                      aria-label="modal"
                      data-bs-toggle="modal"
                      data-bs-target="#Modal"
                    >
                      <i class="fa-solid fa-right-to-bracket fa-xl"></i>
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <!-- Modal -->
      <div
        class="modal fade"
        id="Modal"
        tabindex="-1"
        aria-labelledby="ModalLabel"
        aria-hidden="true"
        (hidden.bs.modal)="resetModalData()"
      >
        <div class="modal-dialog modal-xl">
          <div class="modal-content">
            <div class="modal-header float-right">
              <h5>Detalle Documentos</h5>
              <div class="text-right">
                <i
                  data-bs-dismiss="modal"
                  aria-label="Close"
                  class="fa fa-close"
                ></i>
              </div>
            </div>
            <div class="modal-body">
              <div class="mb-4">
                <!-- Tarjeta con información encima Modal-->
                <div class="card">
                  <div class="card-body">
                    <div class="row">
                      <div class="col-sm-3 mb-3">
                        <h6 class="card-title text-muted">Descripción Color</h6>
                        <p class="card-text">
                          <i class="fas fa-palette text-primary"></i>
                          {{ selectedItem.nameColor }}
                        </p>
                      </div>
                      <div class="col-sm-2 mb-3">
                        <h6 class="card-title text-muted">Código Color</h6>
                        <p class="card-text">
                          <i class="fas fa-code text-success"></i>
                          {{ selectedItem.codeColor }}
                        </p>
                      </div>
                      <div class="col-sm-4 mb-3">
                        <h6 class="card-title text-muted">Descripción Color</h6>
                        <p class="card-text">
                          <i class="fa-solid fa-file-code text-info"></i>
                          {{ selectedItem.nameCloth }}
                        </p>
                      </div>
                      <div class="col-sm-2 mb-3">
                        <h6 class="card-title text-muted">Lote</h6>
                        <p class="card-text">
                          <i class="fas fa-tags text-warning"></i>
                          {{ selectedItem.lot }}
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
                <table class="table table-bordered table-hover">
                  <thead>
                    <tr>
                      <th scope="col">#</th>
                      <th scope="col" [ngStyle]="{ 'text-align': 'center' }">
                        Rollo
                      </th>
                      <th scope="col" [ngStyle]="{ 'text-align': 'center' }">
                        Peso
                      </th>
                      <th scope="col" [ngStyle]="{ 'text-align': 'center' }">
                        RTO
                      </th>
                      <th scope="col" [ngStyle]="{ 'text-align': 'center' }">
                        %EA
                      </th>
                      <th scope="col" [ngStyle]="{ 'text-align': 'center' }">
                        %EL
                      </th>
                      <th scope="col" [ngStyle]="{ 'text-align': 'center' }">
                        %VIRO
                      </th>
                      <th scope="col" [ngStyle]="{ 'text-align': 'center' }">
                        Elongacion Ancho
                      </th>
                      <th scope="col" [ngStyle]="{ 'text-align': 'center' }">
                        Elongacion Largo
                      </th>
                      <th scope="col" [ngStyle]="{ 'text-align': 'center' }">
                        <i class="fa-solid fa-exclamation-circle"></i>Defecto
                      </th>
                      <th scope="col" [ngStyle]="{ 'text-align': 'center' }">
                        <i class="fa-solid fa-comment-dots"></i>Observación
                      </th>
                      <th scope="col" [ngStyle]="{ 'text-align': 'center' }">
                        Estado
                      </th>
                      <th scope="col" [ngStyle]="{ 'text-align': 'center' }"></th>
                    </tr>

                  </thead>
                  <tbody>
                    <tr *ngFor="let item of userInputs; let i = index">
                      <th scope="row" class="center-both">{{ i + 1 }}</th>
                      <td class="center-both">{{ item.roll }}</td>
                      <td>
                        <input
                          type="number"
                          min="0"
                          class="form-control"
                          [disabled]="selectedRow !== item.roll"
                          [(ngModel)]="item.peso"
                          [readonly]="selectedRow !== item.roll"
                        />
                      </td>
                      <td>
                        <input
                          type="number"
                          min="0"
                          class="form-control"
                          [disabled]="selectedRow !== item.roll"
                          [(ngModel)]="item.rto"
                          [readonly]="selectedRow !== item.roll"
                        />
                      </td>
                      <td>
                        <input
                          type="number"
                          min="0"
                          class="form-control"
                          [disabled]="selectedRow !== item.roll"
                          [(ngModel)]="item.ea"
                          [readonly]="selectedRow !== item.roll"
                        />
                      </td>
                      <td>
                        <input
                          type="number"
                          min="0"
                          class="form-control"
                          [disabled]="selectedRow !== item.roll"
                          [(ngModel)]="item.el"
                          [readonly]="selectedRow !== item.roll"
                        />
                      </td>
                      <td>
                        <input
                          type="number"
                          min="0"
                          class="form-control"
                          [disabled]="selectedRow !== item.roll"
                          [(ngModel)]="item.viro"
                          [readonly]="selectedRow !== item.roll"
                        />
                      </td>
                      <td>
                        <input
                          type="number"
                          min="0"
                          class="form-control"
                          [disabled]="selectedRow !== item.roll"
                          [(ngModel)]="item.elongacionAncho"
                          [readonly]="selectedRow !== item.roll"
                        />
                      </td>
                      <td>
                        <input
                          type="number"
                          min="0"
                          class="form-control"
                          [disabled]="selectedRow !== item.roll"
                          [(ngModel)]="item.elongacionLargo"
                          [readonly]="selectedRow !== item.roll"
                        />
                      </td>
                      <td>
                        <select
                          class="form-control"
                          [(ngModel)]="item.idRowDefecto"
                          [disabled]="selectedRow !== item.roll"
                        >
                          <option
                            *ngFor="let dp of defectosProveedores"
                            [ngValue]="dp.idRows"
                          >
                            {{ dp.descripcion }} - {{ dp.proveedor }}
                          </option>
                        </select>
                      </td>
                      <td>
                        <input
                          type="text"
                          class="form-control"
                          [disabled]="selectedRow !== item.roll"
                          [(ngModel)]="item.observacion"
                          [readonly]="selectedRow !== item.roll"
                        />
                      </td>
                      <td>
                        <select class="form-control"
                                [disabled]="selectedRow !== item.roll"
                                [(ngModel)]="item.estado">
                          <option [ngValue]="1">Aprobado <i class="fa-regular fa-circle-check" style="color: #63E6BE;"></i></option>
                          <option [ngValue]="0">Rechazado</option>
                        </select>
                      </td>

                      <td>
                        <button
                          type="button"
                          [disabled]="item.isStored"
                          (click)="selectRowForEdit(item.roll)"
                          class="btn-edit"
                          aria-label="edit"
                        >
                          <i class="fa-solid fa-pen-to-square fa-xl"></i>
                        </button>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Cerrar
              </button>
              <button
                type="button"
                class="btn btn-primary"
                (click)="onSaveChanges()"
              >
                Guardar cambios
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
