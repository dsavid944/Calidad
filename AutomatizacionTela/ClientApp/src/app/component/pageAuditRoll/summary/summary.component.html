<div class="px-2 mt-4">
  <div class="row">
    <div class="card mask-body p-0">
      <div class="card-body text-center">
        <div class="row">
          <p class="h4 font-weight-bold mb-1 text-black text-start">
            <b>Resumen Telas</b>
          </p>
          <div class="container">
            <div class="card mask-custom p-1">
              <div class="card-body">
                <div class="row">
                  <div class="col-sm-12 col-md-3 col-lg-3 mb-2">
                    <div id="basic" class="form-outline form-white">
                      <input
                        type="text"
                        id="form1"
                        class="form-control form-control-md"
                        placeholder="Busqueda por Lote"
                      />
                    </div>
                  </div>
                  <div class="col-sm-12 col-md-3 col-lg-3 mb-3 mb-2">
                    <div id="location" class="form-outline form-white">
                      <input
                        type="text"
                        id="form2"
                        class="form-control form-control-md"
                        placeholder="Busqueda por Rollo"
                      />
                    </div>
                  </div>
                  <div class="col-sm-6 col-md-3 col-lg-3">
                    <div class="d-flex flex-row">
                      <div class="px-2">
                        <button
                          type="button"
                          class="btn btn-floating"
                          aria-label="Search"
                        >
                          <i class="fa-solid fa-magnifying-glass fa-xl"></i>
                        </button>
                      </div>
                    </div>
                  </div>
                  <div class="col-sm-6 col-md-3 col-lg-3">
                    <div class="d-flex flex-row-reverse bd-highlight">
                      <div class="p-2 bd-highlight">
                        <i
                        class="fa-solid fa-file-excel"
                        style="font-size: 2.5rem; cursor: pointer"
                        (click)="exportExcel()"
                      ></i>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="card">
            <p-table
              [value]="datos"
              dataKey="name"
              [tableStyle]="{ 'min-width': '60rem' }"
            >
              <ng-template pTemplate="header">
                <tr>
                  <th style="width: 3rem"></th>
                  <th pSortableColumn="dateCreate">
                    Fecha <p-sortIcon field="dateCreate"></p-sortIcon>
                  </th>
                  <th pSortableColumn="nameProvider">Proveedor</th>
                  <th pSortableColumn="roll">
                    Rollo <p-sortIcon field="roll"></p-sortIcon>
                  </th>
                  <th pSortableColumn="lot">Lote</th>
                  <th pSortableColumn="nameCloth" style="width: 200px">
                    Descripci√≥n
                  </th>
                  <th pSortableColumn="codeColor">Color</th>
                  <th pSortableColumn="kiloRoll">Kilos</th>
                  <th pSortableColumn="request">Pedidos</th>
                  <th pSortableColumn="reference">Referencia</th>
                  <th pSortableColumn="remision">Remision</th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-data let-expanded="expanded">
                <tr>
                  <td>
                    <button
                      (click)="selected(data.roll)"
                      type="button"
                      pButton
                      pRipple
                      [pRowToggler]="data"
                      class="p-button-text p-button-rounded p-button-plain"
                      [icon]="
                        expanded && roll == data.roll
                          ? 'pi pi-chevron-down'
                          : 'pi pi-chevron-right'
                      "
                      aria-label="Toggle Row"
                    ></button>
                  </td>
                  <td>{{ data.dateCreate | date : "mediumDate" }}</td>
                  <td>{{ data.nameProvider }}</td>
                  <td>{{ data.roll }}</td>
                  <td>{{ data.lot }}</td>
                  <td>{{ data.nameCloth }}</td>
                  <td>{{ data.codeColor }}</td>
                  <td>{{ data.kiloRoll }}</td>
                  <td>{{ data.request }}</td>
                  <td>{{ data.reference }}</td>
                  <td>{{ data.remision }}</td>
                </tr>
              </ng-template>
              <ng-template pTemplate="rowexpansion" let-data>
                <tr *ngIf="roll == data.roll">
                  <td colspan="11">
                    <div class="p-3">
                      <p-table [value]="[data]" styleClass="p-datatable-sm">
                        <ng-template pTemplate="header">
                          <tr>
                            <th pSortableColumn="mtsProvider">
                              Metro Proveedor
                            </th>
                            <th pSortableColumn="widthProvider">
                              Ancho Proveedor
                            </th>
                            <th pSortableColumn="mtsReal">Metro Real</th>
                            <th pSortableColumn="widthReal">Ancho Real</th>
                            <th pSortableColumn="idRowUsuarioRoll">
                              Revisor
                              <p-sortIcon field="idRowUsuarioRoll"></p-sortIcon>
                            </th>
                            <th pSortableColumn="stateRev">
                              Estado Revision
                              <p-sortIcon field="stateRev"></p-sortIcon>
                            </th>
                            <th pSortableColumn="Weight">Peso</th>
                            <th pSortableColumn="rto">RTO</th>
                            <th pSortableColumn="ea">EA</th>
                            <th pSortableColumn="el">EL</th>
                            <th pSortableColumn="viro">VIRO</th>
                            <th pSortableColumn="widthElongation">
                              Ancho Elongacion
                            </th>
                            <th pSortableColumn="longElongation">
                              Largo Elongacio
                            </th>
                            <th pSortableColumn="idRowUsuarioCheck">
                              Chequeador
                              <p-sortIcon
                                field="idRowUsuarioCheck"
                              ></p-sortIcon>
                            </th>
                            <th pSortableColumn="stateCheck">
                              Estado Chequeo
                              <p-sortIcon field="stateCheck"></p-sortIcon>
                            </th>
                            <th style="width: 4rem"></th>
                          </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-info>
                          <tr>
                            <td>{{ info.mtsProvider }}</td>
                            <td>{{ info.widthProvider }}</td>
                            <td>{{ info.mtsReal }}</td>
                            <td>{{ info.widthReal }}</td>
                            <td>{{ info.usuarioRoll }}</td>
                            <td>
                              <p-tag
                                [value]="info.stateRev"
                                [severity]="getSeverity(info.stateRev)"
                              ></p-tag>
                            </td>
                            <td>{{ info.weight }}</td>
                            <td>{{ info.rto }}</td>
                            <td>{{ info.ea }}</td>
                            <td>{{ info.el }}</td>
                            <td>{{ info.viro }}</td>
                            <td>{{ info.widthElongation }}</td>
                            <td>{{ info.longElongation }}</td>
                            <td>{{ info.usuarioCheck }}</td>
                            <td>
                              <p-tag
                                [value]="info.stateCheck"
                                [severity]="getSeverity(info.stateCheck)"
                              ></p-tag>
                            </td>
                          </tr>
                        </ng-template>
                      </p-table>
                    </div>
                  </td>
                </tr>
              </ng-template>
            </p-table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
