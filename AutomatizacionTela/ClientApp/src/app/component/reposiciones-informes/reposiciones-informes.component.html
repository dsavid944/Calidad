<div class="container-fluid">
  <div class="row">
    <h1 class="text-center titulo pb-2">Estadísticas Reposición de Telas</h1>
  </div>
  <div class="row mt-2 pt-2 pb-2 shadow">
    <div class="row">
      <div class="col-1">
        <p-button
          label="Generales"
          [raised]="true"
          [outlined]="showGeneral ? true : false"
          [severity]="showGeneral ? 'secondary' : 'secondary'"
          (onClick)="viewGenerales()"
        ></p-button>
      </div>
      <div class="col-1">
        <p-button
          label="Calidad"
          [raised]="true"
          [outlined]="showCalidad ? true : false"
          [severity]="showCalidad ? 'secondary' : 'secondary'"
          (onClick)="viewCalidad()"
        ></p-button>
      </div>
      <div class="col-1">
        <p-button
          label="Telas"
          [raised]="true"
          [outlined]="showTelas ? true : false"
          [severity]="showTelas ? 'secondary' : 'secondary'"
          (onClick)="viewTelas()"
        ></p-button>
      </div>
      <div class="col-1">
        <p-button
          label="Referencias"
          [raised]="true"
          [outlined]="showReferencias ? true : false"
          [severity]="showReferencias ? 'secondary' : 'secondary'"
          (onClick)="viewReferencias()"
        ></p-button>
      </div>
      <div class="col-1">
        <p-button
          label="Operarios"
          [raised]="true"
          [outlined]="showOperarios ? true : false"
          [severity]="showOperarios ? 'secondary' : 'secondary'"
          (onClick)="viewOperarios()"
        ></p-button>
      </div>
      <div class="col-1">
        <p-button
          label="Tiempos"
          [raised]="true"
          [outlined]="showTiempos ? true : false"
          [severity]="showTiempos ? 'secondary' : 'secondary'"
          (onClick)="viewTiempos()"
        ></p-button>
      </div>
      <div class="col-1">
        <p-button
          label="Causas"
          [raised]="true"
          [outlined]="showCausas ? true : false"
          [severity]="showCausas ? 'secondary' : 'secondary'"
          (onClick)="viewCausas()"
        ></p-button>
      </div>
    </div>
  </div>

  <div class="row mt-4 pt-2 pb-1 shadow" *ngIf="showGeneral">
    <div class="row m-2 p-2">
      <div class="row">
        <div class="col-3">
          <span class="p-float-label">
            <p-calendar
              [(ngModel)]="dateIni"
              inputId="date_ini"
              dateFormat="dd/mm/yy"
            ></p-calendar>
            <label for="date_ini">Fecha Inicial</label>
          </span>
        </div>
        <div class="col-3">
          <span class="p-float-label">
            <p-calendar
              [(ngModel)]="dateFin"
              inputId="date_fin"
              dateFormat="dd/mm/yy"
            ></p-calendar>
            <label for="date_fin">Fecha Final</label>
          </span>
        </div>
        <div class="col-1">
          <p-button
            label="Filtrar"
            [raised]="true"
            severity="secondary"
            (onClick)="filtrarFecha()"
          ></p-button>
        </div>
        <div class="col-3">
          <p-button
            label="Limpiar"
            [raised]="true"
            severity="secondary"
            (onClick)="getDatosFiltros()"
          ></p-button>
        </div>
      </div>
    </div>
    <p-table
      #dt2
      [value]="lstGeneral"
      dataKey="id"
      [rows]="rows"
      [scrollable]="true"
      scrollHeight="40rem"
      [showCurrentPageReport]="true"
      [loading]="loading"
      [paginator]="true"
      currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} entradas"
      [globalFilterFields]="[
        'mes',
        'semana',
        'fecha',
        'referencia',
        'oc',
        'unidades',
        'metros',
        'tiempoPerdido',
        'operario',
        'causas'
      ]"
      [(first)]="first"
      responsiveLayout="scroll"
      [tableStyle]="{ 'min-width': '60rem' }"
      styleClass="p-datatable-sm p-datatable-striped text-center text-xs align-items-center"
    >
      <ng-template pTemplate="header">
        <tr>
          <th>
            <p-columnFilter
              type="text"
              field="mes"
              placeholder="Mes"
            ></p-columnFilter>
          </th>
          <th>
            <p-columnFilter
              type="text"
              field="semana"
              placeholder="Semana"
            ></p-columnFilter>
          </th>
          <th>
            <p-columnFilter
              type="text"
              field="fecha"
              placeholder="Fecha"
            ></p-columnFilter>
          </th>
          <th>
            <p-columnFilter
              type="text"
              field="referencia"
              placeholder="Referencia"
            ></p-columnFilter>
          </th>
          <th>
            <p-columnFilter
              type="text"
              field="oc"
              placeholder="OC"
            ></p-columnFilter>
          </th>
          <th>
            <p-columnFilter
              type="text"
              field="unidades"
              placeholder="Und"
            ></p-columnFilter>
          </th>
          <th>
            <p-columnFilter
              type="text"
              field="metros"
              placeholder="Metros"
            ></p-columnFilter>
          </th>
          <th>
            <p-columnFilter
              type="text"
              field="tiempoPerdido"
              placeholder="Tiempo"
            ></p-columnFilter>
          </th>
          <th>
            <p-columnFilter
              type="text"
              field="operario"
              placeholder="Operario"
            ></p-columnFilter>
          </th>
          <th>
            <p-columnFilter
              type="text"
              field="causas"
              placeholder="Causas"
            ></p-columnFilter>
          </th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-datos>
        <tr style="font-size: 12px">
          <td class="center" style="width: 8%">{{ datos.mes }}</td>
          <td class="center" style="width: 9%">{{ datos.semana }}</td>
          <td class="center" style="width: 9%">
            {{ datos.fecha | date : "dd/MM/yyyy" }}
          </td>
          <td class="center" style="width: 9%">{{ datos.referencia }}</td>
          <td class="center" style="width: 9%">{{ datos.oc }}</td>
          <td class="center" style="width: 8%">{{ datos.unidades }}</td>
          <td class="center" style="width: 9%">{{ datos.metros }}</td>
          <td class="center">
            {{ datos.tiempoPerdido | number : "1.2-2" | percent }}
          </td>
          <td>{{ datos.operario }}</td>
          <td>{{ datos.causas }}</td>
        </tr>
      </ng-template>
    </p-table>
  </div>
  <div class="row mt-2 pt-2 pb-2 shadow" *ngIf="showCalidad" style="max-height: 45rem; overflow-y: auto">
    <p-accordion [activeIndex]="0">
      <p-accordionTab header="Semana">
        <div class="row m-1">
          <div class="col-lg-3 col-md-12">
            <div class="row">
              <div class="col-11">
                <span class="p-float-label">
                  <p-multiSelect
                    [options]="semanas"
                    [(ngModel)]="semanasSeleccionadas"
                    (onChange)="semanasCalidadFiltro()"
                    optionLabel="semana"
                  ></p-multiSelect>
                  <label for="semanas">Semanas</label>
                </span>
                <div class="m-2">
                  <p-chip
                    styleClass="mb-2 me-1"
                    label="{{ item.semana }}"
                    *ngFor="let item of semanasSeleccionadas"
                  ></p-chip>
                </div>
              </div>
              <div class="col-1">
                <p-button
                  label="Limpiar"
                  [raised]="true"
                  severity="secondary"
                  (onClick)="getCalidadSemana()"
                ></p-button>
              </div>
            </div>
            <div class="row">
              <div class="text-center d-flex align-items-center h-100">
                <p-table
                  [value]="lstCalidadSemana"
                  [scrollable]="true"
                  scrollHeight="30rem"
                  styleClass="p-datatable-gridlines p-datatable-sm m-2 tablas-peque"
                  [tableStyle]="{ 'min-width': '5rem', 'min-height': '5rem' }"
                >
                  <ng-template pTemplate="header">
                    <tr>
                      <th pSortableColumn="semana">Semana<p-sortIcon field="semana"></p-sortIcon>
                      <th pSortableColumn="calidad">Calidad<p-sortIcon field="calidad"></p-sortIcon>
                      </th>
                      <th>Meta</th>
                    </tr>
                  </ng-template>
                  <ng-template pTemplate="body" let-data>
                    <tr>
                      <td>{{ data.semana }}</td>
                      <td>{{ data.calidad | percent }}</td>
                      <td>{{ data.meta | percent }}</td>
                    </tr>
                  </ng-template>
                </p-table>
              </div>
            </div>
          </div>
          <div class="col-lg-9 col-md-12">
            <div class="w-100 m-2 d-flex justify-content-center">
              <div style="width: 90%">
                <apx-chart
                  [series]="chartOptions2.series"
                  [chart]="chartOptions2.chart"
                  [xaxis]="chartOptions2.xaxis"
                  [stroke]="chartOptions2.stroke"
                  [dataLabels]="chartOptions2.dataLabels"
                  [legend]="chartOptions2.legend"
                  [yaxis]="chartOptions2.yaxis"
                  [title]="chartOptions2.title"
                ></apx-chart>
              </div>
            </div>
          </div>
        </div>
      </p-accordionTab>
      <p-accordionTab header="Mes">
        <div class="row m-2 p-2">
          <div class="col-lg-3 col-md-12">
            <div class="table-responsive">
              <p-table
                [value]="lstCalidadMes"
                [scrollable]="true"
                scrollHeight="30rem"
                styleClass="p-datatable-gridlines p-datatable-sm m-2 tablas-peque"
                [tableStyle]="{ 'min-width': '10rem' }"
              >
                <ng-template pTemplate="header">
                  <tr>
                    <th>Mes</th>
                    <th pSortableColumn="calidad">
                      Calidad<p-sortIcon field="calidad"></p-sortIcon>
                    </th>
                    <th>Meta</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-data>
                  <tr>
                    <td>{{ data.mes }}</td>
                    <td>{{ data.calidad | percent }}</td>
                    <td>{{ data.meta | percent }}</td>
                  </tr>
                </ng-template>
              </p-table>
            </div>
          </div>
          <div class="col-lg-9 col-md-12">
            <div class="w-100 m-2 d-flex justify-content-center">
              <div style="width: 90%">
                <apx-chart
                  [series]="chartOptions3.series"
                  [chart]="chartOptions3.chart"
                  [xaxis]="chartOptions3.xaxis"
                  [stroke]="chartOptions3.stroke"
                  [dataLabels]="chartOptions3.dataLabels"
                  [legend]="chartOptions3.legend"
                  [yaxis]="chartOptions3.yaxis"
                  [title]="chartOptions3.title"
                ></apx-chart>
              </div>
            </div>
          </div>
        </div>
      </p-accordionTab>
    </p-accordion>
  </div>
  
  <div class="row mt-2 pt-2 pb-2 shadow" *ngIf="showTelas" style="max-height: 45rem; overflow-y: auto">
    <p-accordion [activeIndex]="0">
      <p-accordionTab header="Semana">
        <div class="row m-1">
          <div class="col-lg-3 col-md-12">
            <div class="row">
              <div class="col-11">
                <span class="p-float-label">
                  <p-multiSelect
                    [options]="semanas"
                    [(ngModel)]="semanasSeleccionadas"
                    (onChange)="semanasMetrosFiltro()"
                    optionLabel="semana"
                  ></p-multiSelect>
                  <label for="semanas">Semanas</label>
                </span>
                <div class="m-2">
                  <p-chip
                    styleClass="mb-2 me-1"
                    label="{{ item.semana }}"
                    *ngFor="let item of semanasSeleccionadas"
                  ></p-chip>
                </div>
              </div>
              <div class="col-1">
                <p-button
                  label="Limpiar"
                  [raised]="true"
                  severity="secondary"
                  (onClick)="getReposicionMetrosSemanas()"
                ></p-button>
              </div>
            </div>
            <div class="row">
              <div class="text-center d-flex align-items-center h-100">
                <p-table
                  [value]="lstReposicionMetrosSemana"
                  [scrollable]="true"
                  scrollHeight="30rem"
                  styleClass="p-datatable-gridlines p-datatable-sm m-2 tablas-peque"
                  [tableStyle]="{ 'min-width': '10rem' }"
                >
                  <ng-template pTemplate="header">
                    <tr>
                      <th>Semana</th>
                      <th pSortableColumn="metros">
                        Metros<p-sortIcon field="metros"></p-sortIcon>
                      </th>
                      <th>Valor</th>
                    </tr>
                  </ng-template>
                  <ng-template pTemplate="body" let-data>
                    <tr>
                      <td>{{ data.semana }}</td>
                      <td>{{ data.metros }}</td>
                      <td>
                        {{ data.valor | currency : "$" : "symbol" : "1.0-0" }}
                      </td>
                    </tr>
                  </ng-template>
                </p-table>
              </div>
            </div>
          </div>
          <div class="col-lg-9 col-md-12">
            <div class="w-100 m-2 d-flex justify-content-center">
              <div style="width: 90%">
                <apx-chart
                  [series]="chartOptions.series"
                  [chart]="chartOptions.chart"
                  [xaxis]="chartOptions.xaxis"
                  [stroke]="chartOptions.stroke"
                  [dataLabels]="chartOptions.dataLabels"
                  [legend]="chartOptions.legend"
                  [yaxis]="chartOptions.yaxis"
                  [title]="chartOptions.title"
                ></apx-chart>
              </div>
            </div>
          </div>
        </div>
      </p-accordionTab>
      <p-accordionTab header="Mes">
        <div class="row">
          <div class="col-3">
            <p-table
              [value]="lstReposicionMetrosMes"
              [scrollable]="true"
              scrollHeight="30rem"
              styleClass="p-datatable-gridlines p-datatable-sm m-2 tablas-peque"
              [tableStyle]="{ 'min-width': '10rem' }"
            >
              <ng-template pTemplate="header">
                <tr>
                  <th>Mes</th>
                  <th pSortableColumn="metros">
                    Metros<p-sortIcon field="metros"></p-sortIcon>
                  </th>
                  <th>Valor</th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-data>
                <tr>
                  <td>{{ data.mes }}</td>
                  <td>{{ data.metros }}</td>
                  <td>{{ data.valor | currency : "$" : "symbol" : "1.0-0" }}</td>
                </tr>
              </ng-template>
            </p-table>
          </div>
          <div
            class="col-lg-9 col-md-12 chart-container"
            *ngIf="lstReferencia_Unidades_Metros.length > 0"
          >
            <div class="w-100 m-2 d-flex justify-content-center">
              <div style="width: 90%">
                <apx-chart
                  [series]="chartOptions4.series"
                  [chart]="chartOptions4.chart"
                  [xaxis]="chartOptions4.xaxis"
                  [stroke]="chartOptions4.stroke"
                  [dataLabels]="chartOptions4.dataLabels"
                  [legend]="chartOptions4.legend"
                  [yaxis]="chartOptions4.yaxis"
                  [title]="chartOptions4.title"
                ></apx-chart>
              </div>
            </div>
          </div>
        </div>
      </p-accordionTab>
    </p-accordion>
  </div>
  
  <div class="row mt-2 pt-2 pb-2 shadow" *ngIf="showReferencias" style="max-height: 45rem; overflow-y: auto" >
    <p-accordion [activeIndex]="0">
      <p-accordionTab header="Referencias">
        <div class="row m-1">
          <div class="row">
            <div class="col-3">
              <div class="col-11">
                <span class="p-float-label">
                  <p-multiSelect
                    [options]="semanas"
                    [(ngModel)]="semanasSeleccionadas"
                    (onChange)="referenciaUnidadesMetrosFiltro()"
                    optionLabel="semana"
                  ></p-multiSelect>
                  <label for="semanas">Semanas</label>
                </span>
                <div class="m-2">
                  <p-chip
                    styleClass="mb-2 me-1"
                    label="{{ item.semana }}"
                    *ngFor="let item of semanasSeleccionadas"
                  ></p-chip>
                </div>
              </div>
            </div>
            <div class="col-3">
              <div class="col-11">
                <span class="p-float-label">
                  <p-multiSelect
                    [options]="referencias"
                    [(ngModel)]="referenciasSeleccionadas"
                    (onChange)="referenciaUnidadesMetrosFiltro()"
                    optionLabel="referencia"
                  ></p-multiSelect>
                  <label for="semanas">Referencias</label>
                </span>
                <div class="m-2">
                  <p-chip
                    styleClass="mb-2 me-1"
                    label="{{ item.referencia }}"
                    *ngFor="let item of referenciasSeleccionadas"
                  ></p-chip>
                </div>
              </div>
            </div>
            <div class="col-1">
              <p-button
                label="Limpiar"
                [raised]="true"
                severity="secondary"
                (onClick)="getReferenciaUnidadesMetros()"
              ></p-button>
            </div>
          </div>
          <div class="col-lg-3 col-md-12">
            <div class="row">
              <div class="text-center d-flex align-items-center h-100">
                <p-table
                  [value]="lstReferencia_Unidades_Metros"
                  [scrollable]="true"
                  scrollHeight="30rem"
                  styleClass="p-datatable-gridlines p-datatable-sm m-2 tablas-peque"
                  [tableStyle]="{ 'min-width': '5rem', 'min-height': '5rem' }"
                >
                  <ng-template pTemplate="header">
                    <tr>
                      <th pSortableColumn="semana">
                        Semana<p-sortIcon field="semana"></p-sortIcon>
                      </th>
                      <th>Referencia</th>
                      <th pSortableColumn="unidades">
                        Unidades<p-sortIcon field="unidades"></p-sortIcon>
                      </th>
                      <th pSortableColumn="metros">
                        Metros<p-sortIcon field="metros"></p-sortIcon>
                      </th>
                    </tr>
                  </ng-template>
                  <ng-template pTemplate="body" let-data>
                    <tr>
                      <td class="center">{{ data.semana }}</td>
                      <td class="center">{{ data.referencia }}</td>
                      <td class="center">{{ data.unidades }}</td>
                      <td class="center">{{ data.metros }}</td>
                    </tr>
                  </ng-template>
                </p-table>
              </div>
            </div>
          </div>
          <div
            class="col-lg-9 col-md-12 chart-container"
            *ngIf="lstReferencia_Unidades_Metros.length > 0"
          >
            <div class="w-100 m-2 d-flex justify-content-center">
              <div style="width: 90%">
                <apx-chart
                  [series]="chartOptions5.series"
                  [chart]="chartOptions5.chart"
                  [xaxis]="chartOptions5.xaxis"
                  [stroke]="chartOptions5.stroke"
                  [dataLabels]="chartOptions5.dataLabels"
                  [legend]="chartOptions5.legend"
                  [yaxis]="chartOptions5.yaxis"
                  [title]="chartOptions5.title"
                ></apx-chart>
              </div>
            </div>
          </div>
        </div>
      </p-accordionTab>
    </p-accordion>
  </div>

  <div class="row mt-2 pt-2 pb-2 shadow" *ngIf="showOperarios" style="max-height: 45rem; overflow-y: auto" >
    <p-accordion [activeIndex]="0">
      <p-accordionTab header="Metros">
        <div class="row m-1">
          <div class="row">
            <div class="col-3">
              <div class="col-11">
                <span class="p-float-label">
                  <p-multiSelect [options]="semanas" [(ngModel)]="semanasSeleccionadas" (onChange)="operariosUnidadesMetrosFiltro() ; UnidadesFiltro()" optionLabel="semana"></p-multiSelect>
                  <label for="semanas">Semanas</label>
                </span>
                <div class="m-2">
                  <p-chip styleClass="mb-2 me-1" label="{{ item.semana }}" *ngFor="let item of semanasSeleccionadas"></p-chip>
                </div>
              </div>
            </div>
            <div class="col-3">
              <div class="col-11">
                <span class="p-float-label">
                  <p-multiSelect
                    [options]="operarios"
                    [(ngModel)]="operariosSeleccionados"
                    (onChange)="operariosUnidadesMetrosFiltro(); UnidadesFiltro()"
                    optionLabel="operario"
                  ></p-multiSelect>
                  <label for="operario">Operarios</label>
                </span>
                <div class="m-2">
                  <p-chip
                    styleClass="mb-2 me-1"
                    label="{{ item.operario }}"
                    *ngFor="let item of operariosSeleccionados"
                  ></p-chip>
                </div>
              </div>
            </div>
            <div class="col-1">
              <p-button
                label="Limpiar"
                [raised]="true"
                severity="secondary"
                (onClick)="getOperarioUnidadesMetros(); getNumeroSolicitudes()"
              ></p-button>
            </div>
          </div>
          <div class="col-lg-3 col-md-12">
            <div class="row">
              <div class="text-center d-flex align-items-center h-100">
                <p-table
                  [value]="lstgetOperarioUnidadesMetros"
                  [scrollable]="true"
                  scrollHeight="30rem"
                  styleClass="p-datatable-gridlines p-datatable-sm m-2 tablas-peque"
                  [tableStyle]="{ 'min-width': '5rem', 'min-height': '5rem' }"
                >
                  <ng-template pTemplate="header">
                    <tr>
                      <th pSortableColumn="semana">
                        Semana<p-sortIcon field="semana"></p-sortIcon>
                      </th>
                      <th>Operario</th>
                      <th pSortableColumn="unidades">
                        Unidades<p-sortIcon field="unidades"></p-sortIcon>
                      </th>
                      <th pSortableColumn="metros">
                        Metros<p-sortIcon field="metros"></p-sortIcon>
                      </th>
                    </tr>
                  </ng-template>
                  <ng-template pTemplate="body" let-data>
                    <tr>
                      <td class="center">{{ data.semana }}</td>
                      <td class="center">{{ data.operario }}</td>
                      <td class="center">{{ data.unidades }}</td>
                      <td class="center">{{ data.metros }}</td>
                    </tr>
                  </ng-template>
                </p-table>
              </div>
            </div>
          </div>
          <div
            class="col-lg-9 col-md-12"
            *ngIf="lstgetOperarioUnidadesMetros.length > 0"
          >
            <div class="m-2 d-flex justify-content-center">
              <div style="width: 100%">
                <apx-chart
                  [series]="chartOptions6.series"
                  [chart]="chartOptions6.chart"
                  [xaxis]="chartOptions6.xaxis"
                  [stroke]="chartOptions6.stroke"
                  [dataLabels]="chartOptions6.dataLabels"
                  [legend]="chartOptions6.legend"
                  [responsive]="chartOptions6.responsive"
                  [yaxis]="chartOptions6.yaxis"
                  [title]="chartOptions6.title"
                ></apx-chart>
              </div>
            </div>
          </div>
        </div>
      </p-accordionTab>
      <p-accordionTab header="Número de Solicitudes">
        <div class="row m-1">
          <div class="row">
            <div class="col-3">
              <div class="col-11">
                <span class="p-float-label">
                  <p-multiSelect
                    [options]="semanas"
                    [(ngModel)]="semanasSeleccionadas"
                    (onChange)="UnidadesFiltro(); operariosUnidadesMetrosFiltro();"
                    optionLabel="semana"
                  ></p-multiSelect>
                  <label for="semanas">Semanas</label>
                </span>
                <div class="m-2">
                  <p-chip
                    styleClass="mb-2 me-1"
                    label="{{ item.semana }}"
                    *ngFor="let item of semanasSeleccionadas"
                  ></p-chip>
                </div>
              </div>
            </div>
            <div class="col-3">
              <div class="col-11">
                <span class="p-float-label">
                  <p-multiSelect
                    [options]="operarios"
                    [(ngModel)]="operariosSeleccionados"
                    (onChange)="UnidadesFiltro(); operariosUnidadesMetrosFiltro()"
                    optionLabel="operario"
                  ></p-multiSelect>
                  <label for="operario">Operarios</label>
                </span>
                <div class="m-2">
                  <p-chip
                    styleClass="mb-2 me-1"
                    label="{{ item.operario }}"
                    *ngFor="let item of operariosSeleccionados"
                  ></p-chip>
                </div>
              </div>
            </div>
            <div class="col-1">
              <p-button
                label="Limpiar"
                [raised]="true"
                severity="secondary"
                (onClick)="getNumeroSolicitudes(); getOperarioUnidadesMetros();"
              ></p-button>
            </div>
          </div>
          <div class="col-lg-3 col-md-12">
            <div class="row">
              <div class="text-center d-flex align-items-center h-100">
                <div style="width: 100%">
                  <p-table
                    [value]="lstNumeroSolicitudes"
                    [scrollable]="true"
                    scrollHeight="30rem"
                    styleClass="p-datatable-gridlines p-datatable-sm m-2 tablas-peque2"
                    [tableStyle]="{ 'min-width': '5rem', 'min-height': '10rem' }"
                  >
                    <ng-template pTemplate="header">
                      <tr>
                        <th pSortableColumn="semana">
                          Semana<p-sortIcon field="semana"></p-sortIcon>
                        </th>
                        <th>Mes</th>
                        <th pSortableColumn="year">
                          Año<p-sortIcon field="year"></p-sortIcon>
                        </th>
                        <th>Operario</th>
                        <th pSortableColumn="numeroDeSolicitudes">
                          No. de Solicitudes<p-sortIcon
                            field="numeroDeSolicitudes"
                          ></p-sortIcon>
                        </th>
                      </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-data>
                      <tr>
                        <td class="center">{{ data.semana }}</td>
                        <td class="center">{{ data.mes }}</td>
                        <td class="center">{{ data.year }}</td>
                        <td class="center">{{ data.operario }}</td>
                        <td class="center">{{ data.numeroDeSolicitudes }}</td>
                      </tr>
                    </ng-template>
                  </p-table>
                </div>
              </div>
            </div>
          </div>
          <div
            class="col-lg-9 col-md-12"
            *ngIf="lstgetOperarioUnidadesMetros.length > 0"
          >
            <div class="m-2 d-flex justify-content-center">
              <div style="width: 90%">
                <apx-chart
                  [series]="chartOptions10.series"
                  [chart]="chartOptions10.chart"
                  [xaxis]="chartOptions10.xaxis"
                  [stroke]="chartOptions10.stroke"
                  [dataLabels]="chartOptions10.dataLabels"
                  [legend]="chartOptions10.legend"
                  [responsive]="chartOptions10.responsive"
                  [yaxis]="chartOptions10.yaxis"
                  [title]="chartOptions10.title"
                ></apx-chart>
              </div>
            </div>
          </div>
        </div>
      </p-accordionTab>
    </p-accordion>
  </div>

  <div class="row mt-2 pt-2 pb-2 shadow" *ngIf="showTiempos" style="max-height: 45rem; overflow-y: auto" >
    <p-accordion [activeIndex]="0">
      <p-accordionTab header="Tiempos">
        <div class="row m-1">
          <div class="row">
            <div class="col-3">
              <div class="col-11">
                <span class="p-float-label">
                  <p-multiSelect
                    [options]="semanas"
                    [(ngModel)]="semanasSeleccionadas"
                    (onChange)="tiempoOperarioFiltro()"
                    optionLabel="semana"
                  ></p-multiSelect>
                  <label for="semanas">Semanas</label>
                </span>
                <div class="m-2">
                  <p-chip
                    styleClass="mb-2 me-1"
                    label="{{ item.semana }}"
                    *ngFor="let item of semanasSeleccionadas"
                  ></p-chip>
                </div>
              </div>
            </div>
            <div class="col-3">
              <div class="col-11">
                <span class="p-float-label">
                  <p-multiSelect
                    [options]="operarios"
                    [(ngModel)]="operariosSeleccionados"
                    (onChange)="tiempoOperarioFiltro()"
                    optionLabel="operario"
                  ></p-multiSelect>
                  <label for="operario">Operarios</label>
                </span>
                <div class="m-2">
                  <p-chip
                    styleClass="mb-2 me-1"
                    label="{{ item.operario }}"
                    *ngFor="let item of operariosSeleccionados"
                  ></p-chip>
                </div>
              </div>
            </div>
            <div class="col-1">
              <p-button
                label="Limpiar"
                [raised]="true"
                severity="secondary"
                (onClick)="getOperarioUnidadesMetros()"
              ></p-button>
            </div>
          </div>
          <div class="col-lg-3 col-md-12">
            <div class="row">
              <div class="text-center d-flex align-items-center h-100">
                <div style="width: 100%">
                  <p-table
                    [value]="lstTiempoOperario"
                    [scrollable]="true"
                    scrollHeight="30rem"
                    styleClass="p-datatable-gridlines p-datatable-sm m-2 tablas-peque2"
                    [tableStyle]="{ 'min-width': '5rem', 'min-height': '10rem' }"
                  >
                    <ng-template pTemplate="header">
                      <tr>
                        <th pSortableColumn="semana">
                          Semana<p-sortIcon field="semana"></p-sortIcon>
                        </th>
                        <th>Mes</th>
                        <th>Año</th>
                        <th pSortableColumn="tiempo">
                          Tiempo<p-sortIcon field="tiempo"></p-sortIcon>
                        </th>
                        <th>Operario</th>
                      </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-data>
                      <tr>
                        <td class="center">{{ data.semana }}</td>
                        <td class="center">{{ data.mes }}</td>
                        <td class="center">{{ data.year }}</td>
                        <td class="center">
                          {{ data.tiempo | number : "1.2-2" | percent }}
                        </td>
                        <td>{{ data.operario }}</td>
                      </tr>
                    </ng-template>
                  </p-table>
                </div>
              </div>
            </div>
          </div>
          <div
            class="col-lg-9 col-md-12 chart-container"
            *ngIf="lstgetOperarioUnidadesMetros.length > 0"
          >
            <div class="w-100 m-2 d-flex justify-content-center">
              <div style="width: 90%">
                <apx-chart
                  [series]="chartOptions7.series"
                  [chart]="chartOptions7.chart"
                  [xaxis]="chartOptions7.xaxis"
                  [stroke]="chartOptions7.stroke"
                  [dataLabels]="chartOptions7.dataLabels"
                  [legend]="chartOptions7.legend"
                  [responsive]="chartOptions7.responsive"
                  [yaxis]="chartOptions7.yaxis"
                  [title]="chartOptions7.title"
                ></apx-chart>
              </div>
            </div>
          </div>
        </div>
      </p-accordionTab>
    </p-accordion>
  </div>

  <div class="row mt-2 pt-2 pb-2 shadow" *ngIf="showCausas" style="max-height: 45rem; overflow-y: auto">
    <p-accordion [activeIndex]="0">
      <p-accordionTab header="Detalle">
        <div class="row m-1">
          <div class="row">
            <div class="col-3">
              <div class="col-11">
                <span class="p-float-label">
                  <p-multiSelect
                    [options]="semanas"
                    [(ngModel)]="semanasSeleccionadas"
                    (onChange)="CausasFiltro()"
                    optionLabel="semana"
                  ></p-multiSelect>
                  <label for="semanas">Semanas</label>
                </span>
                <div class="m-2">
                  <p-chip
                    styleClass="mb-2 me-1"
                    label="{{ item.semana }}"
                    *ngFor="let item of semanasSeleccionadas"
                  ></p-chip>
                </div>
              </div>
            </div>
            <div class="col-3">
              <div class="col-11">
                <span class="p-float-label">
                  <p-multiSelect
                    [options]="causas"
                    [(ngModel)]="causasSeleccionados"
                    (onChange)="CausasFiltro()"
                    optionLabel="causa"
                  ></p-multiSelect>
                  <label for="Causa">Causas</label>
                </span>
                <div class="m-2">
                  <p-chip
                    styleClass="mb-2 me-1"
                    label="{{ item.causas }}"
                    *ngFor="let item of causasSeleccionados"
                  ></p-chip>
                </div>
              </div>
            </div>
            <div class="col-1">
              <p-button
                label="Limpiar"
                [raised]="true"
                severity="secondary"
                (onClick)="getDefectosUnidades()"
              ></p-button>
            </div>
          </div>
          <div class="col-lg-3 col-md-12">
            <div class="row">
              <div class="text-center d-flex align-items-center h-100">
                <div style="width: 100%">
                  <p-table
                    [value]="lstDefectoUnidades"
                    [scrollable]="true"
                    scrollHeight="30rem"
                    styleClass="p-datatable-gridlines p-datatable-sm m-2 tablas-peque2"
                    [tableStyle]="{ 'min-width': '15rem', 'min-height': '5rem' }"
                  >
                    <ng-template pTemplate="header">
                      <tr>
                        <th pSortableColumn="semana">
                          Semana<p-sortIcon field="semana"></p-sortIcon>
                        </th>
                        <th>Mes</th>
                        <th>Año</th>
                        <th pSortableColumn="unidades">
                          Unidades<p-sortIcon field="unidades"></p-sortIcon>
                        </th>
                        <th>Causas</th>
                      </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-data>
                      <tr>
                        <td class="center">{{ data.semana }}</td>
                        <td class="center">{{ data.mes }}</td>
                        <td class="center">{{ data.year }}</td>
                        <td class="center">{{ data.unidades }}</td>
                        <td>{{ data.causas }}</td>
                      </tr>
                    </ng-template>
                  </p-table>
                </div>
              </div>
            </div>
          </div>
          <div
            class="col-lg-9 col-md-12 chart-container"
            *ngIf="lstgetOperarioUnidadesMetros.length > 0"
          >
            <div class="w-100 m-2 d-flex justify-content-center">
              <div style="width: 90%">
                <apx-chart
                  [series]="chartOptions8.series"
                  [chart]="chartOptions8.chart"
                  [xaxis]="chartOptions8.xaxis"
                  [stroke]="chartOptions8.stroke"
                  [dataLabels]="chartOptions8.dataLabels"
                  [legend]="chartOptions8.legend"
                  [responsive]="chartOptions8.responsive"
                  [yaxis]="chartOptions8.yaxis"
                  [title]="chartOptions8.title"
                ></apx-chart>
              </div>
            </div>
          </div>
        </div>
      </p-accordionTab>
      <p-accordionTab header="Agrupadas">
        <div class="row m-1">
          <div class="row">
            <div class="col-3">
              <div class="col-11">
                <span class="p-float-label">
                  <p-multiSelect
                    [options]="semanas"
                    [(ngModel)]="semanasSeleccionadas"
                    (onChange)="CausasFiltro()"
                    optionLabel="semana"
                  ></p-multiSelect>
                  <label for="semanas">Semanas</label>
                </span>
                <div class="m-2">
                  <p-chip
                    styleClass="mb-2 me-1"
                    label="{{ item.semana }}"
                    *ngFor="let item of semanasSeleccionadas"
                  ></p-chip>
                </div>
              </div>
            </div>
            <div class="col-3">
              <div class="col-11">
                <span class="p-float-label">
                  <p-multiSelect
                    [options]="causas"
                    [(ngModel)]="causasSeleccionados"
                    (onChange)="CausasFiltro()"
                    optionLabel="causa"
                  ></p-multiSelect>
                  <label for="Causa">Causas</label>
                </span>
                <div class="m-2">
                  <p-chip
                    styleClass="mb-2 me-1"
                    label="{{ item.causas }}"
                    *ngFor="let item of causasSeleccionados"
                  ></p-chip>
                </div>
              </div>
            </div>
            <div class="col-1">
              <p-button
                label="Limpiar"
                [raised]="true"
                severity="secondary"
                (onClick)="getDefectosUnidades()"
              ></p-button>
            </div>
          </div>
          <div class="col-lg-3 col-md-12">
            <div class="row">
              <div class="text-center d-flex align-items-center h-100">
                <div style="width: 100%">
                  <p-table
                    [value]="lstCausasAgrupadasFiltro"
                    [scrollable]="true"
                    scrollHeight="30rem"
                    styleClass="p-datatable-gridlines p-datatable-sm m-2 tablas-peque2"
                    [tableStyle]="{ 'min-width': '15rem', 'min-height': '5rem' }"
                  >
                    <ng-template pTemplate="header">
                      <tr>
                        <th>Causas</th>
                        <th pSortableColumn="unidades">
                          Unidades<p-sortIcon field="unidades"></p-sortIcon>
                        </th>
                      </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-data>
                      <tr>
                        <td>{{ data.causas }}</td>
                        <td class="center">{{ data.unidades }}</td>
                      </tr>
                    </ng-template>
                  </p-table>
                </div>
              </div>
            </div>
          </div>
          <div
            class="col-lg-9 col-md-12 chart-container"
            *ngIf="lstgetOperarioUnidadesMetros.length > 0"
          >
            <div class="w-100 m-2 d-flex justify-content-center">
              <div style="width: 90%">
                <apx-chart
                  [series]="chartOptions9.series"
                  [chart]="chartOptions9.chart"
                  [xaxis]="chartOptions9.xaxis"
                  [stroke]="chartOptions9.stroke"
                  [dataLabels]="chartOptions9.dataLabels"
                  [legend]="chartOptions9.legend"
                  [responsive]="chartOptions9.responsive"
                  [yaxis]="chartOptions9.yaxis"
                  [title]="chartOptions9.title"
                ></apx-chart>
              </div>
            </div>
          </div>
        </div>
      </p-accordionTab>
    </p-accordion>
  </div>
</div>


<ngx-spinner bdColor="rgba(51,51,51,0.8)" size="medium" color="#fff" type="ball-scale-multiple" >
  <p style="font-size: 20px; color: white">Cargando Información...</p>
</ngx-spinner>
